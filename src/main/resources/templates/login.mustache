{{>layouts/header}}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <h3 class="text-center mb-4">ë¡œê·¸ì¸</h3>

            <form>
                <div class="mb-3">
                    <label class="form-label">Email address</label>
                    <input type="email" class="form-control" id="email" placeholder="name@example.com">
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="password">
                </div>

                <button type="button" class="btn btn-primary w-100 mb-2" id="login-submit-btn">ë¡œê·¸ì¸</button>
            </form>

            <a href="/oauth2/authorization/google" class="btn btn-success w-100 active" role="button">Google ë¡œê·¸ì¸</a>

            <div class="mt-3 text-center">
                <a href="/signup" class="btn btn-link">íšŒì›ê°€ì…</a>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // ğŸ‘‡ [ìˆ˜ì •] ë°”ë€ IDë¡œ ì°¾ê¸°
        const loginSubmitBtn = document.getElementById('login-submit-btn');

        if (loginSubmitBtn) {
            loginSubmitBtn.addEventListener('click', function() {

                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;

                if (!email || !password) {
                    alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }

                // API í˜¸ì¶œ
                fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                })
                        .then(response => {
                            if (response.ok) {
                                return response.json();
                            } else {
                                alert("ë¡œê·¸ì¸ ì‹¤íŒ¨! ì•„ì´ë””/ë¹„ë²ˆì„ í™•ì¸í•˜ì„¸ìš”.");
                                throw new Error("Login failed");
                            }
                        })
                        .then(data => {
                            localStorage.setItem('access_token', data.token);
                            alert("ë¡œê·¸ì¸ ì„±ê³µ!");
                            window.location.replace('/articles');
                        })
                        .catch(error => console.error("Error:", error));
            });
        }
    });
</script>

{{>layouts/footer}}